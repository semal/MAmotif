# MAmotif 项目总结报告

## 项目概述
MAmotif 是一个专注于整合 motif 信息和 ChIP-seq 结合信号变化的生物信息学分析项目。该项目主要用于分析转录因子结合位点（peaks）和 DNA 序列 motif 的关系，特别是在不同细胞类型或实验条件下的比较分析。

## 主要功能模块

### 1. 核心分析模块
- **MAmotif.py**: 主要的分析流程脚本，实现了完整的 MAmotif 分析管道
  - 支持将 MAnorm 结果的 peaks 按照是否位于启动子区域分类
  - 对不同类型的 peaks 进行 motif 富集分析
  - 提供命令行接口，支持批量分析

### 2. Peak 分析模块
- **peak_set_analysis.py**: Peak 集合分析工具
  - 计算不同 peak 集合之间的重叠情况
  - 使用 Fisher 精确检验评估 peak 集合的富集程度
  - 支持随机模拟来评估重叠的统计显著性

### 3. 基因集分析模块
- **gene_set_analysis.py**: 基因集合分析工具
  - 计算两个基因列表的重叠情况
  - 使用 Fisher 精确检验评估基因集的富集程度
  - 支持转录本 ID 到基因符号的转换

### 4. Motif 分析模块
- **jaspar3.py**: JASPAR 数据库 motif 分析
  - 包含 196 个 JASPAR3 数据库中的 motif 信息
  - 支持读取 motif 扫描结果
  - 提供 motif 名称和扫描结果的映射

### 5. RNA-seq 分析模块
- **RNAseq_analyses/**: RNA-seq 数据分析工具集
  - DESeq 差异表达分析
  - RPKM 值计算
  - 读取计数统计
  - 转录本 ID 到基因符号转换

### 6. 核心数据结构和 I/O 模块
- **MAmotif_pkg/**: 核心包含多个子模块
  - **MAmotifIO.py**: 数据输入输出处理
  - **MAmotifPeaks.py**: Peak 数据结构定义
  - **MAnormPeaksClassifier.py**: Peak 分类器
  - **sequence.py**: 序列处理工具
  - **sequence_permutation.py**: 序列置换分析

## 数据文件结构

### 参考数据
- **data/**: 包含各种参考数据文件
  - RefGene 注释文件（hg19, mm9 等基因组版本）
  - JASPAR3 motif 名称列表
  - 人鼠基因同源性数据
  - 差异表达基因列表
  - ChIP-seq peak 数据

### 分析结果
- **analyses/**: 存放各种分析脚本和结果
  - 人鼠同源性分析
  - motif 分类的 peak 可视化
  - 测试结果分析
  - DAVID 功能注释分析

## 主要分析流程

1. **Peak 预处理**: 从 MAnorm 结果中读取 peak 数据
2. **Peak 分类**: 根据基因组注释将 peaks 分为启动子区域和远端区域
3. **Motif 扫描**: 在 peak 序列中扫描 JASPAR 数据库中的 motif
4. **统计检验**: 使用 t-test 或 Fisher 精确检验评估 motif 富集的显著性
5. **结果输出**: 生成富集分析结果和可视化图表

## 技术特点

- **多基因组支持**: 支持人类（hg19）和小鼠（mm9）基因组
- **统计严谨**: 使用多重假设检验校正（Benjamin-Hochberg, Bonferroni）
- **模块化设计**: 各功能模块独立，便于维护和扩展
- **命令行友好**: 提供完整的命令行接口
- **数据格式兼容**: 支持多种常见的生物信息学数据格式

## 应用场景

1. **转录因子结合位点分析**: 识别在不同条件下富集的转录因子 motif
2. **表观遗传学研究**: 分析组蛋白修饰与转录因子结合的关系
3. **细胞类型比较**: 比较不同细胞类型中的转录调控差异
4. **基因调控网络分析**: 构建基于 motif 的基因调控网络

## 项目优势

- **集成性强**: 整合了 peak 分析、motif 分析、基因表达分析等多个层面
- **统计可靠**: 采用严格的统计方法确保结果的可靠性
- **易于使用**: 提供简洁的命令行接口和丰富的文档
- **扩展性好**: 模块化设计便于添加新功能和支持新的数据类型

这个项目为转录调控研究提供了一个完整的分析工具集，特别适用于 ChIP-seq 和 RNA-seq 数据的整合分析。